# nlmixr2extra

The goal of nlmixr2extra is to provide the tools to help with common
pharmacometric tasks with nlmixr2 models like bootstrapping, covariate
selection etc.

## Installation

You can install the development version of nlmixr2extra from
[GitHub](https://github.com/) with:

``` r
# install.packages("remotes")
remotes::install_github("nlmixr2/nlmixr2data")
remotes::install_github("nlmixr2/lotri")
remotes::install_github("nlmixr2/rxode2")
remotes::install_github("nlmixr2/nlmixr2est")
remotes::install_github("nlmixr2/nlmixr2extra")
```

## Example of a `bootstrapFit()`

This is a basic example of bootstrapping provided by this package

``` r
library(nlmixr2est)
#> Loading required package: nlmixr2data
library(nlmixr2extra)
# basic example code
# The basic model consists of an ini block that has initial estimates
one.compartment <- function() {
  ini({
    tka <- 0.45; label("Absorption rate, Ka")
    tcl <- 1; label("Clearance, Cl")
    tv <- 3.45; label("Central volumne, V")
    eta.ka ~ 0.6
    eta.cl ~ 0.3
    eta.v ~ 0.1
    add.sd <- 0.7; label("Additive residual error")
  })
  # and a model block with the error specification and model specification
  model({
    ka <- exp(tka + eta.ka)
    cl <- exp(tcl + eta.cl)
    v <- exp(tv + eta.v)
    d/dt(depot) = -ka * depot
    d/dt(center) = ka * depot - cl / v * center
    cp = center / v
    cp ~ add(add.sd)
  })
}

# The fit is performed by the function nlmixr/nlmixr2 specifying the model, data
# and estimate (in a real estimate, nBurn and nEm would be much higher.)
fit <- nlmixr2(one.compartment, theo_sd,  est="saem", saemControl(print=0, nBurn = 10, nEm = 20))
#> ℹ parameter labels from comments are typically ignored in non-interactive mode
#> ℹ Need to run with the source intact to parse comments
#> → loading into symengine environment...
#> → pruning branches (`if`/`else`) of saem model...
#> ✔ done
#> → finding duplicate expressions in saem model...
#> [====|====|====|====|====|====|====|====|====|====] 0:00:00
#> → optimizing duplicate expressions in saem model...
#> [====|====|====|====|====|====|====|====|====|====] 0:00:00
#> ✔ done
#> using C compiler: 'gcc.exe (GCC) 13.2.0'
#> ℹ calculate uninformed etas
#> ℹ done
#> rxode2 3.0.2 using 8 threads (see ?getRxThreads)
#>   no cache: create with `rxCreateCache()`
#> 
#> Attaching package: 'rxode2'
#> The following objects are masked from 'package:nlmixr2est':
#> 
#>     boxCox, yeoJohnson
#> Calculating covariance matrix
#> → loading into symengine environment...
#> → pruning branches (`if`/`else`) of saem model...
#> ✔ done
#> → finding duplicate expressions in saem predOnly model 0...
#> → finding duplicate expressions in saem predOnly model 1...
#> → optimizing duplicate expressions in saem predOnly model 1...
#> → finding duplicate expressions in saem predOnly model 2...
#> ✔ done
#> using C compiler: 'gcc.exe (GCC) 13.2.0'
#> → Calculating residuals/tables
#> ✔ done
#> → compress origData in nlmixr2 object, save 5952
#> → compress phiM in nlmixr2 object, save 3712
#> → compress parHistData in nlmixr2 object, save 2456
#> → compress saem0 in nlmixr2 object, save 27920

# In a real bootstrap, nboot would be much higher.
fit2 <- suppressMessages(bootstrapFit(fit, nboot = 5))
fit2
```

# Package index

## All functions

- [`adaptivelassoCoefficients()`](https://nlmixr2.github.io/nlmixr2extra/reference/adaptivelassoCoefficients.md)
  : Return Adaptive lasso coefficients after finding optimal t
- [`addCatCovariates()`](https://nlmixr2.github.io/nlmixr2extra/reference/addCatCovariates.md)
  : Make dummy variable cols and updated covarsVec
- [`addorremoveCovariate()`](https://nlmixr2.github.io/nlmixr2extra/reference/addorremoveCovariate.md)
  : Add covariate
- [`adjustedlassoCoefficients()`](https://nlmixr2.github.io/nlmixr2extra/reference/adjustedlassoCoefficients.md)
  : Return Adjusted adaptive lasso coefficients after finding optimal t
- [`bootplot()`](https://nlmixr2.github.io/nlmixr2extra/reference/bootplot.md)
  : Produce delta objective function for boostrap
- [`bootstrapFit()`](https://nlmixr2.github.io/nlmixr2extra/reference/bootstrapFit.md)
  : Bootstrap nlmixr2 fit
- [`buildcovInfo()`](https://nlmixr2.github.io/nlmixr2extra/reference/buildcovInfo.md)
  : Build covInfo list from varsVec and covarsVec
- [`buildupatedUI()`](https://nlmixr2.github.io/nlmixr2extra/reference/buildupatedUI.md)
  : Build updated from the covariate and variable vector list
- [`fixedControl()`](https://nlmixr2.github.io/nlmixr2extra/reference/fixedControl.md)
  : Control options for fixed-value likelihood profiling
- [`foldgen()`](https://nlmixr2.github.io/nlmixr2extra/reference/foldgen.md)
  : Stratified cross-validation fold generator function, inspired from
  the caret
- [`horseshoeSummardf()`](https://nlmixr2.github.io/nlmixr2extra/reference/horseshoeSummardf.md)
  : Create Horseshoe summary posterior estimates
- [`knit_print(`*`<nlmixr2FitCore>`*`)`](https://nlmixr2.github.io/nlmixr2extra/reference/knit_print.nlmixr2FitCore.md)
  [`knit_print(`*`<rxUi>`*`)`](https://nlmixr2.github.io/nlmixr2extra/reference/knit_print.nlmixr2FitCore.md)
  : Extract the equations from an nlmixr2/rxode2 model to produce a
  'LaTeX' equation.
- [`lassoCoefficients()`](https://nlmixr2.github.io/nlmixr2extra/reference/lassoCoefficients.md)
  : Return Final lasso coefficients after finding optimal t
- [`lassoSummardf()`](https://nlmixr2.github.io/nlmixr2extra/reference/lassoSummardf.md)
  : Create Lasso summary posterior estimates
- [`llpControl()`](https://nlmixr2.github.io/nlmixr2extra/reference/llpControl.md)
  : Control options for log-likelihood profiling
- [`normalizedData()`](https://nlmixr2.github.io/nlmixr2extra/reference/normalizedData.md)
  : Function to return data of normalized covariates
- [`optimUnisampling()`](https://nlmixr2.github.io/nlmixr2extra/reference/optimUnisampling.md)
  : Sample from uniform distribution by optim
- [`preconditionFit()`](https://nlmixr2.github.io/nlmixr2extra/reference/preconditionFit.md)
  : Linearly re-parameterize the model to be less sensitive to rounding
  errors
- [`profile(`*`<nlmixr2FitCore>`*`)`](https://nlmixr2.github.io/nlmixr2extra/reference/profile.nlmixr2FitCore.md)
  : Perform likelihood profiling on nlmixr2 focei fits
- [`profileFixed()`](https://nlmixr2.github.io/nlmixr2extra/reference/profileFixed.md)
  [`profileFixedSingle()`](https://nlmixr2.github.io/nlmixr2extra/reference/profileFixed.md)
  : Estimate the objective function values for a model while fixing
  defined parameter values
- [`profileLlp()`](https://nlmixr2.github.io/nlmixr2extra/reference/profileLlp.md)
  : Profile confidence intervals with log-likelihood profiling
- [`profileNlmixr2FitCoreRet()`](https://nlmixr2.github.io/nlmixr2extra/reference/profileNlmixr2FitCoreRet.md)
  : Give the output data.frame for a single model for
  profile.nlmixr2FitCore
- [`regularmodel()`](https://nlmixr2.github.io/nlmixr2extra/reference/regularmodel.md)
  : Regular lasso model
- [`theoFitOde`](https://nlmixr2.github.io/nlmixr2extra/reference/theoFitOde.md)
  : Example single dose Theophylline ODE model

